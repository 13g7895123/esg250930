{"file":"users-p3NElDIx.js","mappings":"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","names":["error","_ssrRenderAttrs","_mergeProps","_unref","_ssrRenderComponent","_ssrRenderList","_ssrInterpolate","_ssrIncludeBooleanAttr","_ssrRenderAttr","_ssrLooseContain","_ssrLooseEqual"],"sources":["../../../../composables/useUsers.js","../../../../pages/settings/users.vue"],"sourcesContent":["/**\r\n * User Management API composable\r\n */\r\nexport const useUsers = () => {\r\n  const { get, post, put, patch, del } = useApi()\r\n\r\n  /**\r\n   * Get all users with pagination and filtering\r\n   */\r\n  const getUsers = async (params = {}) => {\r\n    const queryParams = new URLSearchParams()\r\n    \r\n    if (params.search) queryParams.append('search', params.search)\r\n    if (params.role) queryParams.append('role', params.role)\r\n    if (params.status) queryParams.append('status', params.status)\r\n    if (params.page) queryParams.append('page', params.page)\r\n    if (params.per_page) queryParams.append('per_page', params.per_page)\r\n    if (params.sort) queryParams.append('sort', params.sort)\r\n    if (params.order) queryParams.append('order', params.order)\r\n\r\n    const queryString = queryParams.toString()\r\n    const endpoint = queryString ? `/users?${queryString}` : '/users'\r\n    \r\n    return await get(endpoint)\r\n  }\r\n\r\n  /**\r\n   * Get specific user by ID\r\n   */\r\n  const getUser = async (id) => {\r\n    return await get(`/users/${id}`)\r\n  }\r\n\r\n  /**\r\n   * Create new user\r\n   */\r\n  const createUser = async (userData) => {\r\n    return await post('/users', userData)\r\n  }\r\n\r\n  /**\r\n   * Update user\r\n   */\r\n  const updateUser = async (id, userData) => {\r\n    return await put(`/users/${id}`, userData)\r\n  }\r\n\r\n  /**\r\n   * Delete user (soft delete)\r\n   */\r\n  const deleteUser = async (id) => {\r\n    return await del(`/users/${id}`)\r\n  }\r\n\r\n  /**\r\n   * Toggle user status (active/inactive/suspended)\r\n   */\r\n  const toggleUserStatus = async (id, status) => {\r\n    return await patch(`/users/${id}/status`, { status })\r\n  }\r\n\r\n  /**\r\n   * Change user password\r\n   */\r\n  const changeUserPassword = async (id, passwordData) => {\r\n    return await patch(`/users/${id}/password`, passwordData)\r\n  }\r\n\r\n  /**\r\n   * Restore soft deleted user\r\n   */\r\n  const restoreUser = async (id) => {\r\n    return await patch(`/users/${id}/restore`)\r\n  }\r\n\r\n  /**\r\n   * Permanently delete user\r\n   */\r\n  const forceDeleteUser = async (id) => {\r\n    return await del(`/users/${id}/force`)\r\n  }\r\n\r\n  /**\r\n   * Get user statistics\r\n   */\r\n  const getUserStats = async () => {\r\n    return await get('/users/stats')\r\n  }\r\n\r\n  return {\r\n    // Core operations\r\n    getUsers,\r\n    getUser,\r\n    createUser,\r\n    updateUser,\r\n    deleteUser,\r\n    \r\n    // Status management\r\n    toggleUserStatus,\r\n    changeUserPassword,\r\n    \r\n    // Advanced operations\r\n    restoreUser,\r\n    forceDeleteUser,\r\n    getUserStats\r\n  }\r\n}","<template>\r\n  <div class=\"space-y-6\">\r\n    <div class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6\">\r\n      <div class=\"flex items-center justify-between mb-6\">\r\n        <h2 class=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n          {{ t('nav.user_management') }}\r\n        </h2>\r\n        <div class=\"flex items-center space-x-4\">\r\n          <!-- Search -->\r\n          <div class=\"relative\">\r\n            <input\r\n              v-model=\"searchQuery\"\r\n              type=\"text\"\r\n              placeholder=\"搜尋用戶...\"\r\n              class=\"w-64 px-4 py-2 pl-10 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n            <MagnifyingGlassIcon class=\"w-5 h-5 text-gray-400 absolute left-3 top-2.5\" />\r\n          </div>\r\n          \r\n          <!-- Add User Button -->\r\n          <button\r\n            @click=\"showCreateModal = true\"\r\n            class=\"inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\r\n          >\r\n            <PlusIcon class=\"w-4 h-4 mr-2\" />\r\n            新增用戶\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Access Denied for Non-Admin -->\r\n      <div v-if=\"!authStore.isAdmin\" class=\"text-center py-12\">\r\n        <ShieldExclamationIcon class=\"w-12 h-12 text-red-500 mx-auto mb-4\" />\r\n        <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">{{ t('auth.access_denied') }}</h3>\r\n        <p class=\"text-gray-600 dark:text-gray-400\">{{ t('auth.admin_only_feature') }}</p>\r\n      </div>\r\n\r\n      <!-- Users Table -->\r\n      <div v-else class=\"overflow-x-auto\">\r\n        <table class=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\r\n          <thead class=\"bg-gray-50 dark:bg-gray-700\">\r\n            <tr>\r\n              <th class=\"px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-200 tracking-wide\">\r\n                用戶資訊\r\n              </th>\r\n              <th class=\"px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-200 tracking-wide\">\r\n                角色權限\r\n              </th>\r\n              <th class=\"px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-200 tracking-wide\">\r\n                帳號狀態\r\n              </th>\r\n              <th class=\"px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-200 tracking-wide\">\r\n                最後登入時間\r\n              </th>\r\n              <th class=\"px-6 py-4 text-left text-sm font-semibold text-gray-700 dark:text-gray-200 tracking-wide\">\r\n                操作功能\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n          <tbody class=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n            <tr v-for=\"user in filteredUsers\" :key=\"user.id\" class=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\r\n              <!-- User Info -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <div class=\"flex items-center\">\r\n                  <div class=\"w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center\">\r\n                    <UserCircleIcon class=\"w-8 h-8 text-gray-500 dark:text-gray-400\" />\r\n                  </div>\r\n                  <div class=\"ml-4\">\r\n                    <div class=\"text-sm font-medium text-gray-900 dark:text-white\">{{ user?.name || '未知用戶' }}</div>\r\n                    <div class=\"text-sm text-gray-500 dark:text-gray-400\">{{ user?.email || '未設定Email' }}</div>\r\n                    <div v-if=\"user?.username\" class=\"text-xs text-gray-400 dark:text-gray-500\">@{{ user.username }}</div>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n\r\n              <!-- Role -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <span \r\n                  class=\"inline-flex px-3 py-1 text-sm font-medium rounded-full\"\r\n                  :class=\"{\r\n                    'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400': user?.role === 'admin',\r\n                    'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400': user?.role === 'user'\r\n                  }\"\r\n                >\r\n                  {{ user?.role === 'admin' ? '管理員' : '一般用戶' }}\r\n                </span>\r\n              </td>\r\n\r\n              <!-- Status -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap\">\r\n                <span \r\n                  class=\"inline-flex px-3 py-1 text-sm font-medium rounded-full\"\r\n                  :class=\"{\r\n                    'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400': user?.status === 'active',\r\n                    'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400': user?.status === 'inactive',\r\n                    'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400': user?.status === 'suspended'\r\n                  }\"\r\n                >\r\n                  {{ \r\n                    user?.status === 'active' ? '正常使用' : \r\n                    user?.status === 'suspended' ? '已暫停' :\r\n                    '已停用'\r\n                  }}\r\n                </span>\r\n              </td>\r\n\r\n              <!-- Last Login -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white\">\r\n                {{ formatDate(user?.last_login_at) }}\r\n              </td>\r\n\r\n              <!-- Actions -->\r\n              <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                <div class=\"flex items-center space-x-2\">\r\n                  <!-- Toggle Status -->\r\n                  <button\r\n                    v-if=\"user?.id !== authStore.user?.id\"\r\n                    @click=\"toggleStatus(user)\"\r\n                    class=\"text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 transition-colors duration-200\"\r\n                    :disabled=\"!user?.id\"\r\n                  >\r\n                    {{ user?.status === 'active' ? t('auth.deactivate') : t('auth.activate') }}\r\n                  </button>\r\n                  \r\n                  <!-- Edit -->\r\n                  <button\r\n                    @click=\"editUser(user)\"\r\n                    class=\"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 transition-colors duration-200\"\r\n                  >\r\n                    {{ t('common.edit') }}\r\n                  </button>\r\n                  \r\n                  <!-- Delete -->\r\n                  <button\r\n                    v-if=\"user?.id !== authStore.user?.id\"\r\n                    @click=\"handleDeleteUser(user)\"\r\n                    class=\"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200\"\r\n                    :disabled=\"!user?.id\"\r\n                  >\r\n                    刪除\r\n                  </button>\r\n                </div>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <!-- No Users Found -->\r\n        <div v-if=\"!loading && filteredUsers.length === 0\" class=\"text-center py-12\">\r\n          <UsersIcon class=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\r\n          <p class=\"text-gray-500 dark:text-gray-400\">{{ t('auth.no_users_found') }}</p>\r\n        </div>\r\n\r\n        <!-- Loading State -->\r\n        <div v-if=\"loading\" class=\"text-center py-12\">\r\n          <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500 mx-auto mb-4\"></div>\r\n          <p class=\"text-gray-500 dark:text-gray-400\">載入中...</p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Pagination -->\r\n      <div v-if=\"!loading && filteredUsers.length > 0 && pagination.last_page > 1\" class=\"mt-6 flex items-center justify-between border-t border-gray-200 dark:border-gray-700 pt-4\">\r\n        <div class=\"text-sm text-gray-700 dark:text-gray-300\">\r\n          顯示 {{ pagination.from }} 到 {{ pagination.to }} 筆，共 {{ pagination.total }} 筆用戶\r\n        </div>\r\n        <div class=\"flex items-center space-x-2\">\r\n          <button\r\n            @click=\"goToPrevPage()\"\r\n            :disabled=\"pagination.current_page <= 1 || loading\"\r\n            class=\"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            上一頁\r\n          </button>\r\n          \r\n          <span class=\"text-sm text-gray-700 dark:text-gray-300\">\r\n            第 {{ pagination.current_page }} 頁，共 {{ pagination.last_page }} 頁\r\n          </span>\r\n          \r\n          <button\r\n            @click=\"goToNextPage()\"\r\n            :disabled=\"pagination.current_page >= pagination.last_page || loading\"\r\n            class=\"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          >\r\n            下一頁\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Edit User Modal -->\r\n    <div v-if=\"showEditModal\" class=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\r\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-xl max-w-md w-full p-6\">\r\n        <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n          {{ t('auth.edit_user') }}\r\n        </h3>\r\n        \r\n        <div class=\"space-y-4\">\r\n          <!-- Name -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              {{ t('auth.full_name') }}\r\n            </label>\r\n            <input\r\n              v-model=\"editForm.name\"\r\n              type=\"text\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n          \r\n          <!-- Email -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              {{ t('auth.email') }}\r\n            </label>\r\n            <input\r\n              v-model=\"editForm.email\"\r\n              type=\"email\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n\r\n          <!-- Role -->\r\n          <div v-if=\"editForm.id !== authStore.user?.id\">\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              {{ t('auth.role') }}\r\n            </label>\r\n            <select\r\n              v-model=\"editForm.role\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            >\r\n              <option value=\"user\">{{ t('auth.role_user') }}</option>\r\n              <option value=\"admin\">{{ t('auth.role_admin') }}</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Modal Actions -->\r\n        <div class=\"flex justify-end space-x-3 mt-6\">\r\n          <button\r\n            @click=\"showEditModal = false\"\r\n            class=\"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200\"\r\n          >\r\n            {{ t('common.cancel') }}\r\n          </button>\r\n          <button\r\n            @click=\"saveUser\"\r\n            class=\"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors duration-200\"\r\n          >\r\n            {{ t('common.save') }}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Create User Modal -->\r\n    <div v-if=\"showCreateModal\" class=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\r\n      <div class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-xl max-w-md w-full p-6 max-h-[90vh] overflow-y-auto\">\r\n        <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\r\n          新增用戶\r\n        </h3>\r\n        \r\n        <div class=\"space-y-4\">\r\n          <!-- Name -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              姓名 *\r\n            </label>\r\n            <input\r\n              v-model=\"createForm.name\"\r\n              type=\"text\"\r\n              required\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n          \r\n          <!-- Username -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              用戶名 *\r\n            </label>\r\n            <input\r\n              v-model=\"createForm.username\"\r\n              type=\"text\"\r\n              required\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n          \r\n          <!-- Email -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              Email *\r\n            </label>\r\n            <input\r\n              v-model=\"createForm.email\"\r\n              type=\"email\"\r\n              required\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n\r\n          <!-- Password -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              密碼 *\r\n            </label>\r\n            <input\r\n              v-model=\"createForm.password\"\r\n              type=\"password\"\r\n              required\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n\r\n          <!-- Confirm Password -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              確認密碼 *\r\n            </label>\r\n            <input\r\n              v-model=\"createForm.password_confirmation\"\r\n              type=\"password\"\r\n              required\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            />\r\n          </div>\r\n\r\n          <!-- Role -->\r\n          <div>\r\n            <label class=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n              角色\r\n            </label>\r\n            <select\r\n              v-model=\"createForm.role\"\r\n              class=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\r\n            >\r\n              <option value=\"user\">一般用戶</option>\r\n              <option value=\"admin\">管理員</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Modal Actions -->\r\n        <div class=\"flex justify-end space-x-3 mt-6\">\r\n          <button\r\n            @click=\"showCreateModal = false\"\r\n            class=\"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200\"\r\n          >\r\n            取消\r\n          </button>\r\n          <button\r\n            @click=\"saveNewUser\"\r\n            class=\"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors duration-200\"\r\n          >\r\n            建立\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n// Page metadata\r\ndefinePageMeta({\r\n  middleware: 'admin'\r\n})\r\nimport {\r\n  MagnifyingGlassIcon,\r\n  ShieldExclamationIcon,\r\n  UsersIcon,\r\n  PlusIcon,\r\n  UserCircleIcon\r\n} from '@heroicons/vue/24/outline'\r\n\r\nconst { t } = useI18n()\r\nconst authStore = useAuthStore()\r\nconst { getUsers, updateUser, deleteUser, toggleUserStatus, createUser } = useUsers()\r\n\r\n// Reactive data\r\nconst searchQuery = ref('')\r\nconst showEditModal = ref(false)\r\nconst showCreateModal = ref(false)\r\nconst editForm = ref({})\r\nconst createForm = ref({\r\n  name: '',\r\n  username: '',\r\n  email: '',\r\n  password: '',\r\n  password_confirmation: '',\r\n  role: 'user',\r\n  status: 'active'\r\n})\r\nconst users = ref([])\r\nconst loading = ref(false)\r\nconst error = ref(null)\r\nconst pagination = ref({\r\n  current_page: 1,\r\n  last_page: 1,\r\n  per_page: 15,\r\n  total: 0,\r\n  from: 0,\r\n  to: 0\r\n})\r\nconst currentPage = ref(1)\r\n\r\n// Load users data\r\nconst loadUsers = async (page = 1) => {\r\n  try {\r\n    loading.value = true\r\n    error.value = null\r\n    const response = await getUsers({\r\n      search: searchQuery.value,\r\n      page: page,\r\n      per_page: 15,\r\n      sort: '-created_at'\r\n    })\r\n    \r\n    if (response.success) {\r\n      users.value = response.data || []\r\n      pagination.value = response.pagination || {\r\n        current_page: 1,\r\n        last_page: 1,\r\n        per_page: 15,\r\n        total: 0,\r\n        from: 0,\r\n        to: 0\r\n      }\r\n      currentPage.value = page\r\n    } else {\r\n      throw new Error(response.message || 'Failed to load users')\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message\r\n    console.error('Failed to load users:', err)\r\n    users.value = []\r\n    pagination.value = {\r\n      current_page: 1,\r\n      last_page: 1,\r\n      per_page: 15,\r\n      total: 0,\r\n      from: 0,\r\n      to: 0\r\n    }\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// Since backend handles search, we don't need client-side filtering\r\nconst filteredUsers = computed(() => {\r\n  return users.value\r\n})\r\n\r\n// Pagination helpers\r\nconst goToPage = async (page) => {\r\n  if (page >= 1 && page <= pagination.value.last_page) {\r\n    await loadUsers(page)\r\n  }\r\n}\r\n\r\nconst goToPrevPage = async () => {\r\n  if (pagination.value.current_page > 1) {\r\n    await goToPage(pagination.value.current_page - 1)\r\n  }\r\n}\r\n\r\nconst goToNextPage = async () => {\r\n  if (pagination.value.current_page < pagination.value.last_page) {\r\n    await goToPage(pagination.value.current_page + 1)\r\n  }\r\n}\r\n\r\n// Watch search query and reload users from first page\r\nwatch(searchQuery, async () => {\r\n  currentPage.value = 1\r\n  await loadUsers(1)\r\n}, { debounce: 500 })\r\n\r\n// Format date for display\r\nconst formatDate = (date) => {\r\n  if (!date) return '未曾登入'\r\n  try {\r\n    return new Date(date).toLocaleDateString('zh-TW', {\r\n      year: 'numeric',\r\n      month: '2-digit',\r\n      day: '2-digit',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n      hour12: false\r\n    })\r\n  } catch (error) {\r\n    console.error('Invalid date:', date)\r\n    return '日期格式錯誤'\r\n  }\r\n}\r\n\r\n// Toggle user status\r\nconst toggleStatus = async (user) => {\r\n  if (!user?.id) return\r\n  try {\r\n    const newStatus = user.status === 'active' ? 'inactive' : 'active'\r\n    const response = await toggleUserStatus(user.id, newStatus)\r\n    \r\n    if (response.success) {\r\n      await loadUsers() // Reload users to reflect changes\r\n    } else {\r\n      throw new Error(response.message || 'Failed to toggle user status')\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to toggle user status:', error)\r\n    alert('Failed to toggle user status: ' + error.message)\r\n  }\r\n}\r\n\r\n// Edit user\r\nconst editUser = (user) => {\r\n  if (!user) return\r\n  editForm.value = { ...user }\r\n  showEditModal.value = true\r\n}\r\n\r\n// Save user changes\r\nconst saveUser = async () => {\r\n  if (!editForm.value?.id) return\r\n  try {\r\n    const response = await updateUser(editForm.value.id, {\r\n      name: editForm.value.name,\r\n      username: editForm.value.username,\r\n      email: editForm.value.email,\r\n      role: editForm.value.role,\r\n      phone: editForm.value.phone,\r\n      bio: editForm.value.bio,\r\n      company: editForm.value.company,\r\n      position: editForm.value.position,\r\n      location: editForm.value.location,\r\n      website: editForm.value.website\r\n    })\r\n    \r\n    if (response.success) {\r\n      showEditModal.value = false\r\n      await loadUsers() // Reload users to reflect changes\r\n    } else {\r\n      throw new Error(response.message || 'Failed to update user')\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to update user:', error)\r\n    alert('Failed to update user: ' + error.message)\r\n  }\r\n}\r\n\r\n// Create new user\r\nconst saveNewUser = async () => {\r\n  try {\r\n    const response = await createUser(createForm.value)\r\n    \r\n    if (response.success) {\r\n      showCreateModal.value = false\r\n      // Reset form\r\n      createForm.value = {\r\n        name: '',\r\n        username: '',\r\n        email: '',\r\n        password: '',\r\n        password_confirmation: '',\r\n        role: 'user',\r\n        status: 'active'\r\n      }\r\n      await loadUsers() // Reload users to reflect changes\r\n    } else {\r\n      throw new Error(response.message || 'Failed to create user')\r\n    }\r\n  } catch (error) {\r\n    console.error('Failed to create user:', error)\r\n    alert('Failed to create user: ' + error.message)\r\n  }\r\n}\r\n\r\n// Delete user\r\nconst handleDeleteUser = async (user) => {\r\n  if (!user?.id) return\r\n  if (confirm('確定要刪除這位用戶嗎？')) {\r\n    try {\r\n      const response = await deleteUser(user.id)\r\n      \r\n      if (response.success) {\r\n        await loadUsers() // Reload users to reflect changes\r\n      } else {\r\n        throw new Error(response.message || 'Failed to delete user')\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to delete user:', error)\r\n      alert('Failed to delete user: ' + error.message)\r\n    }\r\n  }\r\n}\r\n\r\n// Load users on mount\r\nonMounted(async () => {\r\n  await loadUsers()\r\n})\r\n</script>"],"version":3}