{"version":3,"file":"admin-hl85HoFd.js","sources":["../../../../middleware/admin.js"],"sourcesContent":["export default defineNuxtRouteMiddleware(async (to) => {\r\n  const authStore = useAuthStore()\r\n  \r\n  // 初始化認證狀態\r\n  await authStore.initializeAuth()\r\n  \r\n  // 檢查是否已登入\r\n  if (!authStore.isLoggedIn) {\r\n    console.log('[Admin Middleware] User not authenticated, redirecting to login')\r\n    return navigateTo('/auth/login')\r\n  }\r\n  \r\n  // 嘗試驗證token是否仍然有效\r\n  try {\r\n    await authStore.fetchUser()\r\n  } catch (error) {\r\n    console.warn('[Admin Middleware] Token validation failed:', error.message)\r\n    return navigateTo('/auth/login')\r\n  }\r\n  \r\n  // 檢查是否有管理員權限\r\n  if (!authStore.isAdmin) {\r\n    console.log('[Admin Middleware] User is not admin, access denied')\r\n    throw createError({\r\n      statusCode: 403,\r\n      statusMessage: 'Access denied. Administrator privileges required.'\r\n    })\r\n  }\r\n})"],"names":["__executeAsync"],"mappings":";;;;;;;;;;;;;;;;;;AACA,MAAA,QAAe,0BAAmB,OAAA,OAAA;AAAA,MAAA,QAAA;AAChC,QAAA,YAAA,aAAA;AAGA,EAAA,CAAA,QAAA,SAAA,IAAAA,aAAA,MAAA,UAAA,gBAAA,GAAA,MAAA,QAAA,UAAA;AAGA,MAAI,CAAC,UAAU,YAAY;AACzB,YAAQ,IAAI,iEAAoB;AACjC,WAAA,WAAA,aAAA;AAAA,EACD;AAGA,MAAC;AACC;AAAC,IAAE,CAAC,QAAO,SAAI,IAAAA,aAAA,MAAA,UAAA,UAAA,CAAA,GAAA,MAAA,QAAA,UAAA;AAAA,EACjB,SAAS,OAAO;AACd,YAAQ,KAAK,+CAAmB,MAAA,OAAA;AACjC,WAAA,WAAA,aAAA;AAAA,EACD;AAGA,MAAI,CAAC,UAAU,SAAS;AACtB,YAAQ,IAAI,qDAAO;AACnB,UAAM,YAAY;AAAA,MAChB,YAAY;AAAA,MACZ,eAAA;AAAA,IACN,CAAG;AAAA,EACH;;"}