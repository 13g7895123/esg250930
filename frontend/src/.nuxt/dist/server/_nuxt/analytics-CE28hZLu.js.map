{"version":3,"file":"analytics-CE28hZLu.js","sources":["../../../../pages/dashboard/analytics.vue"],"sourcesContent":["<template>\r\n  <div class=\"space-y-6\">\r\n    <!-- Header -->\r\n    <div class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6\">\r\n      <h2 class=\"text-2xl font-bold text-gray-900 dark:text-white mb-4\">\r\n        分析概覽\r\n      </h2>\r\n      <p class=\"text-gray-600 dark:text-gray-300\">\r\n        詳細的業務分析數據和圖表統計\r\n      </p>\r\n    </div>\r\n\r\n    <!-- Loading State -->\r\n    <div v-if=\"loading\" class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6\">\r\n      <div class=\"animate-pulse\">\r\n        <div class=\"h-4 bg-gray-300 rounded w-1/4 mb-4\"></div>\r\n        <div class=\"space-y-3\">\r\n          <div class=\"h-4 bg-gray-300 rounded w-full\"></div>\r\n          <div class=\"h-4 bg-gray-300 rounded w-3/4\"></div>\r\n          <div class=\"h-4 bg-gray-300 rounded w-1/2\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Stats Cards -->\r\n    <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\" v-if=\"!loading\">\r\n      <div\r\n        v-for=\"stat in statsCards\"\r\n        :key=\"stat.title\"\r\n        class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6\"\r\n      >\r\n        <div class=\"flex items-center\">\r\n          <div class=\"flex-shrink-0\">\r\n            <div :class=\"stat.iconClass\" class=\"w-8 h-8 rounded-md flex items-center justify-center\">\r\n              <component :is=\"stat.icon\" class=\"w-5 h-5 text-white\" />\r\n            </div>\r\n          </div>\r\n          <div class=\"ml-5 w-0 flex-1\">\r\n            <dl>\r\n              <dt class=\"text-sm font-medium text-gray-500 dark:text-gray-400 truncate\">\r\n                {{ stat.title }}\r\n              </dt>\r\n              <dd class=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                {{ stat.value }}\r\n              </dd>\r\n            </dl>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Revenue Trend Chart -->\r\n    <div class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6\" v-if=\"!loading\">\r\n      <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">收入趨勢</h3>\r\n      <div class=\"h-64 flex items-center justify-center text-gray-500 dark:text-gray-400\">\r\n        {{ revenueTrend.length > 0 ? `${revenueTrend.length} 個月的數據` : '暫無收入趨勢數據' }}\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Recent Activities -->\r\n    <div class=\"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6\" v-if=\"!loading\">\r\n      <h3 class=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">近期活動</h3>\r\n      <div class=\"space-y-3\" v-if=\"activities.length > 0\">\r\n        <div\r\n          v-for=\"activity in activities\"\r\n          :key=\"activity?.id || 'empty'\"\r\n          class=\"flex items-center space-x-3 py-2\"\r\n          v-if=\"activity\"\r\n        >\r\n          <div class=\"flex-shrink-0\">\r\n            <div class=\"w-2 h-2 bg-blue-400 rounded-full\"></div>\r\n          </div>\r\n          <div class=\"flex-1 min-w-0\">\r\n            <p class=\"text-sm text-gray-900 dark:text-white\">{{ activity?.description || '無描述' }}</p>\r\n            <p class=\"text-xs text-gray-500 dark:text-gray-400\">{{ formatDate(activity?.created_at) }}</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <p v-else class=\"text-gray-500 dark:text-gray-400\">暫無近期活動</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n// Page metadata\r\ndefinePageMeta({\r\n  middleware: 'auth'\r\n})\r\n\r\nimport {\r\n  CurrencyDollarIcon,\r\n  BriefcaseIcon,\r\n  UsersIcon,\r\n  CheckCircleIcon\r\n} from '@heroicons/vue/24/outline'\r\n\r\nconst { \r\n  getDashboardStats, \r\n  getMonthlyRevenueTrend, \r\n  getRecentActivities \r\n} = useDashboard()\r\n\r\n// Reactive data\r\nconst loading = ref(true)\r\nconst error = ref(null)\r\nconst dashboardStats = ref({})\r\nconst revenueTrend = ref([])\r\nconst activities = ref([])\r\n\r\n// Computed stats cards\r\nconst statsCards = computed(() => [\r\n  {\r\n    title: '總收入',\r\n    value: `NT$${(dashboardStats.value.total_revenue || 0).toLocaleString()}`,\r\n    icon: CurrencyDollarIcon,\r\n    iconClass: 'bg-green-500'\r\n  },\r\n  {\r\n    title: '專案總數',\r\n    value: dashboardStats.value.total_projects || 0,\r\n    icon: BriefcaseIcon,\r\n    iconClass: 'bg-blue-500'\r\n  },\r\n  {\r\n    title: '業主總數',\r\n    value: dashboardStats.value.total_clients || 0,\r\n    icon: UsersIcon,\r\n    iconClass: 'bg-purple-500'\r\n  },\r\n  {\r\n    title: '已完成專案',\r\n    value: dashboardStats.value.completed_projects || 0,\r\n    icon: CheckCircleIcon,\r\n    iconClass: 'bg-green-500'\r\n  }\r\n])\r\n\r\n// Methods\r\nconst loadDashboardData = async () => {\r\n  loading.value = true\r\n  error.value = null\r\n\r\n  try {\r\n    // Load dashboard stats\r\n    const statsResponse = await getDashboardStats()\r\n    if (statsResponse.success) {\r\n      dashboardStats.value = statsResponse.data\r\n    }\r\n\r\n    // Load revenue trend\r\n    const trendResponse = await getMonthlyRevenueTrend(12)\r\n    if (trendResponse.success) {\r\n      revenueTrend.value = trendResponse.data\r\n    }\r\n\r\n    // Load recent activities\r\n    const activitiesResponse = await getRecentActivities(10)\r\n    if (activitiesResponse.success) {\r\n      activities.value = activitiesResponse.data\r\n    }\r\n  } catch (err) {\r\n    error.value = err.message || '載入數據失敗'\r\n    console.error('Dashboard loading error:', err)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst formatDate = (dateString) => {\r\n  if (!dateString) return '未設定'\r\n  return new Date(dateString).toLocaleDateString('zh-TW', {\r\n    year: 'numeric',\r\n    month: 'short',\r\n    day: 'numeric'\r\n  })\r\n}\r\n\r\n// Load data on mount\r\nonMounted(() => {\r\n  loadDashboardData()\r\n})\r\n</script>"],"names":["_ssrRenderAttrs","_mergeProps","_unref","_ssrRenderList","_ssrRenderClass","_ssrRenderVNode","_createVNode","_resolveDynamicComponent","_ssrInterpolate","activity"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAoGI,iBAAY;AAGhB,UAAM,UAAU,IAAI,IAAI;AACV,QAAI,IAAI;AACtB,UAAM,iBAAiB,IAAI,EAAE;AAC7B,UAAM,eAAe,IAAI,EAAE;AAC3B,UAAM,aAAa,IAAI,EAAE;AAGzB,UAAM,aAAa,SAAS,MAAM;AAAA,MAChC;AAAA,QACE,OAAO;AAAA,QACP,OAAO,OAAO,eAAe,MAAM,iBAAiB,GAAG,eAAc,CAAE;AAAA,QACvE,MAAM;AAAA,QACN,WAAW;AAAA,MACf;AAAA,MACE;AAAA,QACE,OAAO;AAAA,QACP,OAAO,eAAe,MAAM,kBAAkB;AAAA,QAC9C,MAAM;AAAA,QACN,WAAW;AAAA,MACf;AAAA,MACE;AAAA,QACE,OAAO;AAAA,QACP,OAAO,eAAe,MAAM,iBAAiB;AAAA,QAC7C,MAAM;AAAA,QACN,WAAW;AAAA,MACf;AAAA,MACE;AAAA,QACE,OAAO;AAAA,QACP,OAAO,eAAe,MAAM,sBAAsB;AAAA,QAClD,MAAM;AAAA,QACN,WAAW;AAAA,MACf;AAAA,IACA,CAAC;AAiCD,UAAM,aAAa,CAAC,eAAe;AACjC,UAAI,CAAC,WAAY,QAAO;AACxB,aAAO,IAAI,KAAK,UAAU,EAAE,mBAAmB,SAAS;AAAA,QACtD,MAAM;AAAA,QACN,OAAO;AAAA,QACP,KAAK;AAAA,MACT,CAAG;AAAA,IACH;;AA9KO,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,eAAW,MAAA,CAAA,CAAA,6NAAA;UAYTC,MAAA,OAAA,GAAO;;;;;WAYuDA,MAAA,OAAA,GAAO;;AAE7DC,sBAAAD,MAAA,UAAA,IAAR,SAAI;AAMM,gBAAA,gJAAAE,eAAA,CAAA,KAAK,WAAS,qDAAA,CAAA,CAAA,IAAA;AACTC,yBAAA,OAAAC,YAAAC,wBAAA,KAAK,IAAI,GAAA,EAAE,OAAM,wBAAoB,IAAA,GAAA,OAAA;0IAMhDC,eAAA,KAAK,KAAK,uEAGVA,eAAA,KAAK,KAAK;;;;;;WASqDN,MAAA,OAAA,GAAO;AAG9E,cAAA,0OAAAM,eAAAN,MAAA,YAAA,EAAa,SAAM,IAAA,GAAUA,MAAA,YAAA,EAAa,MAAM,WAAA,UAAA,CAAA,cAAA;AAAA;;;WAKuBA,MAAA,OAAA,GAAO;;AAEtD,YAAAA,MAAA,UAAA,EAAW,SAAM,GAAA;;cAKpCO,KAAAA,UAAQ;;AAHKN,0BAAAD,MAAA,UAAA,IAAZ,aAAQ;uOASuCM,gBAAA,qCAAU,gBAAW,KAAA,2EAClB,WAAW,qCAAU,UAAU,CAAA;;;;;;;;;;;;;;;;;;;;;;;;"}