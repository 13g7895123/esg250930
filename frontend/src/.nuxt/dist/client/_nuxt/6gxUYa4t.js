import{V as n,n as o,W as a,G as r,X as d}from"./BxfpjSiT.js";const u=n(async c=>{let e,t;const i=o();if([e,t]=a(()=>i.initializeAuth()),await e,t(),!i.isLoggedIn)return console.log("[Admin Middleware] User not authenticated, redirecting to login"),r("/auth/login");try{[e,t]=a(()=>i.fetchUser()),await e,t()}catch(s){return console.warn("[Admin Middleware] Token validation failed:",s.message),r("/auth/login")}if(!i.isAdmin)throw console.log("[Admin Middleware] User is not admin, access denied"),d({statusCode:403,statusMessage:"Access denied. Administrator privileges required."})});export{u as default};
