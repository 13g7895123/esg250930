import{u as C,r as D}from"./C5J7RP-m.js";import{c as r,o as a,a as e,r as c,b as V,d as $,f as i,u as d,I as j,F as x,e as p,t as u,k as B,x as R,g as S,h as A}from"./BxfpjSiT.js";import{r as M}from"./B8rHME0O.js";function N(y,h){return a(),r("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z"})])}const T={class:"space-y-6"},L={key:0,class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6"},z={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},F={class:"flex items-center"},E={class:"flex-shrink-0"},H={class:"ml-5 w-0 flex-1"},I={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},W={class:"text-lg font-medium text-gray-900 dark:text-white"},Z={key:2,class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6"},q={class:"h-64 flex items-center justify-center text-gray-500 dark:text-gray-400"},G={key:3,class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6"},J={key:0,class:"space-y-3"},K={class:"flex-1 min-w-0"},O={class:"text-sm text-gray-900 dark:text-white"},P={class:"text-xs text-gray-500 dark:text-gray-400"},Q={key:1,class:"text-gray-500 dark:text-gray-400"},ee={__name:"analytics",setup(y){const{getDashboardStats:h,getMonthlyRevenueTrend:_,getRecentActivities:w}=C(),n=c(!0),v=c(null),l=c({}),g=c([]),m=c([]),f=V(()=>[{title:"總收入",value:`NT$${(l.value.total_revenue||0).toLocaleString()}`,icon:D,iconClass:"bg-green-500"},{title:"專案總數",value:l.value.total_projects||0,icon:N,iconClass:"bg-blue-500"},{title:"業主總數",value:l.value.total_clients||0,icon:B,iconClass:"bg-purple-500"},{title:"已完成專案",value:l.value.completed_projects||0,icon:M,iconClass:"bg-green-500"}]),k=async()=>{n.value=!0,v.value=null;try{const o=await h();o.success&&(l.value=o.data);const t=await _(12);t.success&&(g.value=t.data);const s=await w(10);s.success&&(m.value=s.data)}catch(o){v.value=o.message||"載入數據失敗",console.error("Dashboard loading error:",o)}finally{n.value=!1}},b=o=>o?new Date(o).toLocaleDateString("zh-TW",{year:"numeric",month:"short",day:"numeric"}):"未設定";return $(()=>{k()}),(o,t)=>(a(),r("div",T,[t[4]||(t[4]=e("div",{class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6"},[e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," 分析概覽 "),e("p",{class:"text-gray-600 dark:text-gray-300"}," 詳細的業務分析數據和圖表統計 ")],-1)),d(n)?(a(),r("div",L,t[0]||(t[0]=[j('<div class="animate-pulse"><div class="h-4 bg-gray-300 rounded w-1/4 mb-4"></div><div class="space-y-3"><div class="h-4 bg-gray-300 rounded w-full"></div><div class="h-4 bg-gray-300 rounded w-3/4"></div><div class="h-4 bg-gray-300 rounded w-1/2"></div></div></div>',1)]))):i("",!0),d(n)?i("",!0):(a(),r("div",z,[(a(!0),r(x,null,p(d(f),s=>(a(),r("div",{key:s.title,class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6"},[e("div",F,[e("div",E,[e("div",{class:R([s.iconClass,"w-8 h-8 rounded-md flex items-center justify-center"])},[(a(),S(A(s.icon),{class:"w-5 h-5 text-white"}))],2)]),e("div",H,[e("dl",null,[e("dt",I,u(s.title),1),e("dd",W,u(s.value),1)])])])]))),128))])),d(n)?i("",!0):(a(),r("div",Z,[t[1]||(t[1]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"收入趨勢",-1)),e("div",q,u(d(g).length>0?`${d(g).length} 個月的數據`:"暫無收入趨勢數據"),1)])),d(n)?i("",!0):(a(),r("div",G,[t[3]||(t[3]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"近期活動",-1)),d(m).length>0?(a(),r("div",J,[o.activity?(a(!0),r(x,{key:0},p(d(m),s=>(a(),r("div",{key:(s==null?void 0:s.id)||"empty",class:"flex items-center space-x-3 py-2"},[t[2]||(t[2]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-2 h-2 bg-blue-400 rounded-full"})],-1)),e("div",K,[e("p",O,u((s==null?void 0:s.description)||"無描述"),1),e("p",P,u(b(s==null?void 0:s.created_at)),1)])]))),128)):i("",!0)])):(a(),r("p",Q,"暫無近期活動"))]))]))}};export{ee as default};
