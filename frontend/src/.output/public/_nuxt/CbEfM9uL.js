import{r as u,b as T,d as $,N as A,w as F,c,a as t,v as x,H as M,A as y,B as U,u as n,C as m,K as v,I as w,f as z,F as R,e as E,_ as H,o as p,y as K,t as l,x as h}from"./BxfpjSiT.js";import{u as Q}from"./CRyoS-aO.js";import{r as W}from"./vbYhx-_b.js";import{r as X}from"./BSLA1L1h.js";import{r as Y}from"./D37AenBN.js";const Z={class:"space-y-6"},G={class:"flex justify-between items-center"},I={class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm p-6"},J={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},O={class:"bg-white dark:bg-gray-800 rounded-lg-custom shadow-sm overflow-hidden"},j={class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},te={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ae={class:"px-6 py-4 whitespace-nowrap"},se={class:"text-sm font-medium text-gray-900 dark:text-white"},re={class:"text-sm text-gray-500 dark:text-gray-400"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},de={class:"px-6 py-4 whitespace-nowrap"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},le={class:"px-6 py-4 whitespace-nowrap"},ie={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ue={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ge={class:"flex justify-end space-x-2"},xe={class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400"},ce=["onClick","disabled"],we={__name:"index",setup(ye){const{getProjects:_,deleteProject:C}=Q(),g=u([]),r=u(""),o=u(""),d=u(""),b=u(!1),f=u(null),L=T(()=>g.value.filter(s=>{const a=s.name.toLowerCase().includes(r.value.toLowerCase())||s.description.toLowerCase().includes(r.value.toLowerCase()),i=!o.value||s.category===o.value,e=!d.value||s.status===d.value;return a&&i&&e})),k=async()=>{var a;b.value=!0,f.value=null;const s=await _({search:r.value,category:o.value,status:d.value});s.success?g.value=s.data.data||s.data||[]:(f.value=((a=s.error)==null?void 0:a.message)||"載入專案資料失敗",g.value=[{id:1,name:"ABC公司官網",description:"企業形象網站建置",client:"ABC公司",category:"website",amount:5e4,status:"completed",contact_date:"2024-01-15"},{id:2,name:"自動化備份腳本",description:"伺服器備份自動化",client:"XYZ企業",category:"script",amount:15e3,status:"in_progress",contact_date:"2024-01-20"},{id:3,name:"伺服器維護",description:"定期系統維護",client:"123公司",category:"server",amount:3e4,status:"paid",contact_date:"2024-01-10"}]),b.value=!1},S=()=>{r.value="",o.value="",d.value="",k()},N=async s=>{var i;if(!confirm("確定要刪除此專案嗎？"))return;const a=await C(s);a.success?g.value=g.value.filter(e=>e.id!==s):alert(((i=a.error)==null?void 0:i.message)||"刪除失敗")},V=s=>({website:"網站",script:"腳本",server:"伺服器",custom:"自訂"})[s]||s,B=s=>({website:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",script:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",server:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",custom:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"})[s]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",D=s=>({contacted:"已接洽",in_progress:"進行中",completed:"已完成",paid:"已收款"})[s]||s,P=s=>({contacted:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",in_progress:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",completed:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200"})[s]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",q=s=>s?new Date(s).toLocaleDateString("zh-TW"):"未設定";return $(()=>{const s=A();s.query.q&&(r.value=s.query.q),k()}),F([r,o,d],()=>{}),(s,a)=>{const i=H;return p(),c("div",Z,[t("div",G,[a[4]||(a[4]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"專案管理"),t("p",{class:"text-gray-600 dark:text-gray-300"},"管理所有專案資訊")],-1)),x(i,{to:"/projects/create",class:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},{default:M(()=>[x(n(W),{class:"w-4 h-4 mr-2"}),a[3]||(a[3]=K(" 新增專案 "))]),_:1,__:[3]})]),t("div",I,[t("div",J,[t("div",null,[a[5]||(a[5]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"搜尋專案",-1)),y(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>m(r)?r.value=e:null),type:"text",placeholder:"搜尋專案名稱...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},null,512),[[U,n(r)]])]),t("div",null,[a[7]||(a[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"專案類別",-1)),y(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>m(o)?o.value=e:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},a[6]||(a[6]=[w('<option value="">全部類別</option><option value="website">網站</option><option value="script">腳本</option><option value="server">伺服器</option><option value="custom">自訂</option>',5)]),512),[[v,n(o)]])]),t("div",null,[a[9]||(a[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"專案狀態",-1)),y(t("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>m(d)?d.value=e:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:text-white"},a[8]||(a[8]=[w('<option value="">全部狀態</option><option value="contacted">已接洽</option><option value="in_progress">進行中</option><option value="completed">已完成</option><option value="paid">已收款</option>',5)]),512),[[v,n(d)]])]),t("div",{class:"flex items-end"},[t("button",{onClick:S,class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," 清除篩選 ")])])]),t("div",O,[t("div",j,[t("table",ee,[a[10]||(a[10]=t("thead",{class:"bg-gray-50 dark:bg-gray-900"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 專案名稱 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 業主 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 類別 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 金額 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 狀態 "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 接洽日期 "),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," 操作 ")])],-1)),t("tbody",te,[s.project?(p(!0),c(R,{key:0},E(n(L),e=>(p(),c("tr",{key:(e==null?void 0:e.id)||"empty",class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",ae,[t("div",null,[t("div",se,l((e==null?void 0:e.name)||"未知專案"),1),t("div",re,l((e==null?void 0:e.description)||"無描述"),1)])]),t("td",oe,l((e==null?void 0:e.client)||"未知業主"),1),t("td",de,[t("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",B(e==null?void 0:e.category)])},l(V(e==null?void 0:e.category)),3)]),t("td",ne," NT$"+l(((e==null?void 0:e.amount)||0).toLocaleString()),1),t("td",le,[t("span",{class:h(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",P(e==null?void 0:e.status)])},l(D(e==null?void 0:e.status)),3)]),t("td",ie,l(q(e==null?void 0:e.contact_date)),1),t("td",ue,[t("div",ge,[t("button",xe,[x(n(X),{class:"w-4 h-4"})]),t("button",{onClick:me=>N(e==null?void 0:e.id),class:"text-red-600 hover:text-red-900 dark:text-red-400",disabled:!(e!=null&&e.id)},[x(n(Y),{class:"w-4 h-4"})],8,ce)])])]))),128)):z("",!0)])])])])])}}};export{we as default};
